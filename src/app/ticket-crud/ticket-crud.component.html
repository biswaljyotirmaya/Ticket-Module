<div class="container py-4">
  <div class="card shadow-sm">
    <div class="card-body p-0">
      <table class="table align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>Ticket Title</th>
            <th>Assignee</th>
            <th>Status</th>
            <th>Priority</th>
            <th>Date</th>
            <th>Sub Task</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- ðŸ”¼ Add Ticket Form on Top -->
          <tr>
            <td><input [(ngModel)]="ticket.titleTicket" class="form-control" placeholder="Title" /></td>
            <td><input [(ngModel)]="ticket.assign" class="form-control" placeholder="Assignee" /></td>
            <td>
              <select [(ngModel)]="ticket.status" class="form-select">
                <option value="">Select</option>
                <option value="Open">To Do</option>
                <option value="In Progress">In Progress</option>
                <option value="Closed">Completed</option>
              </select>
            </td>
            <td>
              <select [(ngModel)]="ticket.priority" class="form-select">
                <option value="">Select</option>
                <option value="Low">Low</option>
                <option value="Medium">Medium</option>
                <option value="High">High</option>
              </select>
            </td>
            <td><input type="date" [(ngModel)]="ticket.dateCurrent" class="form-control" /></td>
            <td><textarea [(ngModel)]="ticket.subTask" class="form-control" placeholder="Sub Task"></textarea></td>
            <td>
              <button class="btn btn-success btn-sm me-1" (click)="createTicket()" 
                [disabled]="!ticket.titleTicket || !ticket.status || !ticket.priority">Save</button>
              <button class="btn btn-secondary btn-sm" (click)="resetForm()">Reset</button>
            </td>
          </tr>

          <!-- â¬‡ Existing Tickets -->
          <tr *ngFor="let t of tickets">
            <td>
             <a href="#" (click)="goToTicketPanel(t.sno); $event.preventDefault()" class="fw-bold text-decoration-none">
  {{ t.titleTicket }}
</a>

            </td>
            <td>{{ t.assign || '-' }}</td>
            <td>{{ t.status || '-' }}</td>
            <td>{{ t.priority || '-' }}</td>
            <td>{{ t.dateCurrent || '-' }}</td>
            <td>{{ t.subTask || '-' }}</td>
            <td>
              <button class="btn btn-sm btn-warning me-1" (click)="openEditModal(t)">
                <i class="bi bi-pencil"></i> Edit
              </button>
              <button class="btn btn-sm btn-danger" (click)="confirmDelete(t.sno)">
                <i class="bi bi-trash"></i> Delete
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- âœ… Edit Modal -->
<div class="modal fade" id="editTicketModal" tabindex="-1" aria-labelledby="editTicketModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit Ticket</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body row g-3">
        <div class="col-md-6">
          <label class="form-label">Title</label>
          <input [(ngModel)]="ticket.titleTicket" class="form-control" />
        </div>
        <div class="col-md-6">
          <label class="form-label">Assignee</label>
          <input [(ngModel)]="ticket.assign" class="form-control" />
        </div>
        <div class="col-md-6">
          <label class="form-label">Status</label>
          <select [(ngModel)]="ticket.status" class="form-select">
            <option value="Open">To Do</option>
            <option value="In Progress">In Progress</option>
            <option value="Closed">Completed</option>
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label">Priority</label>
          <select [(ngModel)]="ticket.priority" class="form-select">
            <option value="Low">Low</option>
            <option value="Medium">Medium</option>
            <option value="High">High</option>
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label">Date</label>
          <input type="date" [(ngModel)]="ticket.dateCurrent" class="form-control" />
        </div>
        <div class="col-md-12">
          <label class="form-label">Sub Task</label>
          <textarea [(ngModel)]="ticket.subTask" class="form-control" rows="2"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
        <button class="btn btn-primary btn-sm" (click)="updateTicket()" data-bs-dismiss="modal">Update</button>
      </div>
    </div>
  </div>
</div>

<!-- âœ… Delete Confirmation Modal -->
<div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirm Deletion</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete this ticket?
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
        <button class="btn btn-danger btn-sm" (click)="deleteTicket()" data-bs-dismiss="modal">Delete</button>
      </div>
    </div>
  </div>
</div>
